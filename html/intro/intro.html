<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>敏行后台维护系统</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="">
    <base href="#">

    <!-- Le styles -->
    <link href="../../css/bootstrap.min.css" rel="stylesheet">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
        font-family: "Microsoft Yahei",simsun,"Helvetica Neue",Helvetica,Arial,sans-serif;
        font-size: 14px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }

      @media (max-width: 980px) {
        /* Enable use of floated navbar text */
        .navbar-text.pull-right {
          float: none;
          padding-left: 5px;
          padding-right: 5px;
        }
      }

    </style>
    <link href="../../css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="../../css/digg_pagination.css" rel="stylesheet">
    <link href="../../css/main.css" rel="stylesheet">
    <link rel="../../shortcut icon" href="../../images/favicon.ico" />
    <script src="../../js/jquery.js"></script>
    <script src="../../js/jquery.ui.widget.js"></script>
    <script src="../../js/jquery.iframe-transport.js"></script>
    
    <script src="../../js/bootstrap.min.js"></script>
    <script src="../../js/jquery.pjax.js"></script>
    <script src="../../js/bootstrap.bootbox.js"></script>
    
    <script src="../../js/ajax.js"></script>

  </head>

  <body>
<div id="main" >
    <div class="navbar navbar-inverse navbar-fixed-top" style="height:100px;line-height:25px">
      <div class="" style="border-width:0px;background-image: linear-gradient(to bottom, #4685e2, #2b72da);height:50px">
        <div class="container-fluid" >
          <!-- <button type="button" class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </button> -->
          <img src="../../../logo.png" alt="公司logo" class="brand" style="margin-left:100px;line-height:60px;margin-top:-5px">
          <a class="brand" href="#" ><font color="#ffffff" style="border-left:1px solid #96bef3">&nbsp;&nbsp;&nbsp;后台维护系统</font></a>
          
          <div class="nav-collapse collapse" style="margin-right:120px">
            <!-- <p class="navbar-text pull-right" style="line-height:50px">
               <a href="logout" class="navbar-link" ><font color="#ffffff">退出</font></a>
            </p> -->
            <p class="navbar-text pull-right">&nbsp;</p>
            
            <!-- <p class="navbar-text pull-right">
              <font color="#ffffff">Logged in as</font> <a href="#" class="navbar-link"><font color="#ffffff">admin</font></a>
            </p> -->
            
            <ul class="js-nav nav nav-pills guide-home" >
              <!-- <li class="nav-index active" ><a href="#" style="background-color:#2a65b6;padding:8px 15px 8px;margin-top:4px">管理</a></li> -->
             <!--  <li class="nav-index active"><input value="随机数  <%=Random.rand(99999)%>"/></li> -->
            </ul>
          </div><!--/.nav-collapse -->

        </div>

      </div>


      

    </div>

    <div class="container-fluid" style="margin-top:50px" >
      <div id="top-main-container">
        <div class="row-fluid">
        <div class="" style="margin-left:110px">
         <div class="sidebar">
       <input type="hidden" id="current-page"/>
            <ul class="nav nav-list" id="pjax-container">
              <!-- <div class="user-avatar-wrap">
                <a href="#settings/avatar"><img src="images/minxing.png" class="avatar "></a>
                <a href="#users/1" title=" admin" class="prepend-mini username ellipsis font-large"><strong></strong></a>
              </div> -->
              <li class="nav-header" style="font-size:14px"><i class="icon-list"></i>初始化向导</li>
              <li class="sub active"><a class="manager"  href="1" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第一步   欢迎</a></li>
              <li class="sub disabled"><a class="manager"  href="2" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第二步  许可证</a></li>
              
              <li class="sub disabled"><a class="manager"  href="3" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第三步  启动服务</a></li>
              <li class="sub disabled"><a class="manager"  href="4" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第四步  修改密码</a></li>
              <li class="sub disabled"><a class="manager"  href="5" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第五步  创建社区</a></li>
              <li class="sub disabled"><a class="manager"  href="6" style="height:30px;line-height:30px">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;第六步 完成</a></li>
              
            </ul>
          </div>
        </div><!--/span-->
        <div class="span9" style="width:65%">
				<div id="browser_waring"></div>
          <div data-pjax class="table table-striped" id="main-container">
            <!-- yield begin -->
            
            <!-- yield end -->
          </div>

        </div><!--/span-->
        <div class="span11">
           <a class="btn btn-large btn-success pull-right next-step" id="next-step" href="#">下一步</a>
        </div>
      </div><!--/row-->
      </div>

      <hr>

      <footer>
        <p>&copy; 敏行 2013 - 2015</p>
      </footer>

    </div><!--/.fluid-container-->
</div><!-- main -->
    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    
    

  </body>
  <!-- <link href="css/datepicker.css" rel="stylesheet"> -->
  
  <script type="text/javascript">
  jQuery(function($) {
    $(".manager").off('click').on('click',function(e){
      e.preventDefault();
    });

     var userAgent = navigator.userAgent.toLowerCase(); 
  
		 if ((/msie/.test( userAgent ) || /trident/.test( userAgent )) && !/opera/.test( userAgent )){
			 $("#browser_waring").html("检测到您正在使用IE。由于IE自身的一些问题，本维护系统不支持IE浏览器，请使用火狐或chrome浏览器！");
			 }
    

    Ajax.get("../../getStep",null,function(res, response, xhr){
      var json = JSON.parse(res);
      if(json.status=="200"){
        step = json.step;
        $("#current-page").val(step);
        for(i=0;i<step;i++){
          $($(".manager")[i]).parent().removeClass("disabled");
          activeMgr($(".manager")[i]);
        }
        $(".manager")[step-1].click();
        $("#current-page").val(step);
      }
    });
    
    
    // $(".manager").off('click').on('click',function(e){
    //   $("#main-container").load(e.target.pathname+".html");
      
    //   $(".manager").each(function(m){
    //       $(this).parent().removeClass("active");
    //   });
    //   $(this).parent().addClass("active");
      
    //   e.preventDefault();
    //   arr = e.target.pathname.split('/');

    //   $("#current-page").val(arr[arr.length-1]);
      
    // });
    //$(".manager")[0].click();//默认点击第一个
    //$(document).pjax('[data-pjax] a','#main-container');
  })

   $("#next-step").off('click').on('click',function(e){
      e.preventDefault();
      p = $("#current-page").val();
      invoke($(".manager"),p);
   })

   function nextStep (elem,p){
      activeMgr(elem[p]);
      $(elem[p]).parent().removeClass("disabled");
      elem[p].click();

   }

   function getStep(){
    step = parseInt($("#current-page").val())+1;
    return step;
   }

   function activeMgr(elem){
      $(elem).off('click').on('click',function(e){
        $("#main-container").load(e.target.pathname+".html");
        $(".manager").each(function(m){
          $(this).parent().removeClass("active");
        });
        $(elem).parent().addClass("active");
        arr = e.target.pathname.split('/');
        $("#current-page").val(arr[arr.length-1]);
        e.preventDefault();
      })
   }

   function disableNextStep(){
    btn = $("#next-step");
    btn.html("下一步");
    btn.off('click');
    btn.addClass("disabled");
   }

   function enbleNextStep(){
      btn = $("#next-step");
      btn.html("下一步");
      btn.removeClass("disabled");
      btn.off('click').on('click',function(e){
        e.preventDefault();
        p = $("#current-page").val();
        invoke($(".manager"),p);
      })
   }
  </script>

</html>
